<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="Types of Data Augmentation" property="og:title">
<meta content="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/og-logo.png" property="og:image">
<meta content="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/og-logo.png" property="og:image:secure_url">
<meta content="Types of Data Augmentation" property="og:description"/>
<title>Types of Data Augmentation — mxnet  documentation</title>
<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" rel="stylesheet"/>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet"/>
<link href="../../_static/basic.css" rel="stylesheet" type="text/css">
<link href="../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../_static/mxnet.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
<script src="https://code.jquery.com/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="../../_static/underscore.js" type="text/javascript"></script>
<script src="../../_static/searchtools_custom.js" type="text/javascript"></script>
<script src="../../_static/doctools.js" type="text/javascript"></script>
<script src="../../_static/selectlang.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script type="text/javascript"> jQuery(function() { Search.loadIndex("/versions/1.4.1/searchindex.js"); Search.init();}); </script>
<script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
      Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-96378503-1', 'auto');
      ga('send', 'pageview');

    </script>
<!-- -->
<!-- <script type="text/javascript" src="../../_static/jquery.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="../../_static/underscore.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="../../_static/doctools.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
<!-- -->
<link href="../../genindex.html" rel="index" title="Index">
<link href="../../search.html" rel="search" title="Search"/>
<link href="index.html" rel="up" title="Tutorials"/>
<link href="../r/index.html" rel="next" title="R Tutorials"/>
<link href="profiler.html" rel="prev" title="Profiling MXNet Models"/>
<link href="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet-icon.png" rel="icon" type="image/png"/>
</link></link></link></meta></meta></meta></head>
<body background="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet-background-compressed.jpeg" role="document">
<div class="content-block"><div class="navbar navbar-fixed-top">
<div class="container" id="navContainer">
<div class="innder" id="header-inner">
<h1 id="logo-wrap">
<a href="../../" id="logo"><img src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet_logo.png"/></a>
</h1>
<nav class="nav-bar" id="main-nav">
<a class="main-nav-link" href="/versions/1.4.1/install/index.html">Install</a>
<span id="dropdown-menu-position-anchor">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Gluon <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu">
<li><a class="main-nav-link" href="/versions/1.4.1/tutorials/gluon/gluon.html">About</a></li>
<li><a class="main-nav-link" href="https://www.d2l.ai/">Dive into Deep Learning</a></li>
<li><a class="main-nav-link" href="https://gluon-cv.mxnet.io">GluonCV Toolkit</a></li>
<li><a class="main-nav-link" href="https://gluon-nlp.mxnet.io/">GluonNLP Toolkit</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">API <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu">
<li><a class="main-nav-link" href="/versions/1.4.1/api/python/index.html">Python</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/api/c++/index.html">C++</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/api/clojure/index.html">Clojure</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/api/java/index.html">Java</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/api/julia/index.html">Julia</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/api/perl/index.html">Perl</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/api/r/index.html">R</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/api/scala/index.html">Scala</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor-docs">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Docs <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu-docs">
<li><a class="main-nav-link" href="/versions/1.4.1/faq/index.html">FAQ</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/tutorials/index.html">Tutorials</a>
<li><a class="main-nav-link" href="https://github.com/apache/incubator-mxnet/tree/1.4.1/example">Examples</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/architecture/index.html">Architecture</a></li>
<li><a class="main-nav-link" href="https://cwiki.apache.org/confluence/display/MXNET/Apache+MXNet+Home">Developer Wiki</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/model_zoo/index.html">Model Zoo</a></li>
<li><a class="main-nav-link" href="https://github.com/onnx/onnx-mxnet">ONNX</a></li>
</li></ul>
</span>
<span id="dropdown-menu-position-anchor-community">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Community <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu-community">
<li><a class="main-nav-link" href="http://discuss.mxnet.io">Forum</a></li>
<li><a class="main-nav-link" href="https://github.com/apache/incubator-mxnet/tree/1.4.1">Github</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/community/contribute.html">Contribute</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/community/ecosystem.html">Ecosystem</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/community/powered_by.html">Powered By</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor-version" style="position: relative"><a href="#" class="main-nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true">1.4.1<span class="caret"></span></a><ul id="package-dropdown-menu" class="dropdown-menu"><li><a href="/">master</a></li><li><a href=/versions/1.6/>1.6</a></li><li><a href=/versions/1.5.0/>1.5.0</a></li><li><a href=/versions/1.4.1/>1.4.1</a></li><li><a href=/versions/1.3.1/>1.3.1</a></li><li><a href=/versions/1.2.1/>1.2.1</a></li><li><a href=/versions/1.1.0/>1.1.0</a></li><li><a href=/versions/1.0.0/>1.0.0</a></li><li><a href=/versions/0.12.1/>0.12.1</a></li><li><a href=/versions/0.11.0/>0.11.0</a></li></ul></span></nav>
<script> function getRootPath(){ return "../../" } </script>
<div class="burgerIcon dropdown">
<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">☰</a>
<ul class="dropdown-menu" id="burgerMenu">
<li><a href="/versions/1.4.1/install/index.html">Install</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/tutorials/index.html">Tutorials</a></li>
<li class="dropdown-submenu dropdown">
<a aria-expanded="true" aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" tabindex="-1">Gluon</a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu">
<li><a class="main-nav-link" href="/versions/1.4.1/tutorials/gluon/gluon.html">About</a></li>
<li><a class="main-nav-link" href="http://gluon.mxnet.io">The Straight Dope (Tutorials)</a></li>
<li><a class="main-nav-link" href="https://gluon-cv.mxnet.io">GluonCV Toolkit</a></li>
<li><a class="main-nav-link" href="https://gluon-nlp.mxnet.io/">GluonNLP Toolkit</a></li>
</ul>
</li>
<li class="dropdown-submenu">
<a aria-expanded="true" aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" tabindex="-1">API</a>
<ul class="dropdown-menu">
<li><a class="main-nav-link" href="/versions/1.4.1/api/python/index.html">Python</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/api/c++/index.html">C++</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/api/clojure/index.html">Clojure</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/api/java/index.html">Java</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/api/julia/index.html">Julia</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/api/perl/index.html">Perl</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/api/r/index.html">R</a></li>
<li><a class="main-nav-link" href="/versions/1.4.1/api/scala/index.html">Scala</a></li>
</ul>
</li>
<li class="dropdown-submenu">
<a aria-expanded="true" aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" tabindex="-1">Docs</a>
<ul class="dropdown-menu">
<li><a href="/versions/1.4.1/faq/index.html" tabindex="-1">FAQ</a></li>
<li><a href="/versions/1.4.1/tutorials/index.html" tabindex="-1">Tutorials</a></li>
<li><a href="https://github.com/apache/incubator-mxnet/tree/1.4.1/example" tabindex="-1">Examples</a></li>
<li><a href="/versions/1.4.1/architecture/index.html" tabindex="-1">Architecture</a></li>
<li><a href="https://cwiki.apache.org/confluence/display/MXNET/Apache+MXNet+Home" tabindex="-1">Developer Wiki</a></li>
<li><a href="/versions/1.4.1/model_zoo/index.html" tabindex="-1">Gluon Model Zoo</a></li>
<li><a href="https://github.com/onnx/onnx-mxnet" tabindex="-1">ONNX</a></li>
</ul>
</li>
<li class="dropdown-submenu dropdown">
<a aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" role="button" tabindex="-1">Community</a>
<ul class="dropdown-menu">
<li><a href="http://discuss.mxnet.io" tabindex="-1">Forum</a></li>
<li><a href="https://github.com/apache/incubator-mxnet/tree/1.4.1" tabindex="-1">Github</a></li>
<li><a href="/versions/1.4.1/community/contribute.html" tabindex="-1">Contribute</a></li>
<li><a href="/versions/1.4.1/community/ecosystem.html" tabindex="-1">Ecosystem</a></li>
<li><a href="/versions/1.4.1/community/powered_by.html" tabindex="-1">Powered By</a></li>
</ul>
</li>
<li id="dropdown-menu-position-anchor-version-mobile" class="dropdown-submenu" style="position: relative"><a href="#" tabindex="-1">1.4.1</a><ul class="dropdown-menu"><li><a tabindex="-1" href=/>master</a></li><li><a tabindex="-1" href=/versions/1.6/>1.6</a></li><li><a tabindex="-1" href=/versions/1.5.0/>1.5.0</a></li><li><a tabindex="-1" href=/versions/1.4.1/>1.4.1</a></li><li><a tabindex="-1" href=/versions/1.3.1/>1.3.1</a></li><li><a tabindex="-1" href=/versions/1.2.1/>1.2.1</a></li><li><a tabindex="-1" href=/versions/1.1.0/>1.1.0</a></li><li><a tabindex="-1" href=/versions/1.0.0/>1.0.0</a></li><li><a tabindex="-1" href=/versions/0.12.1/>0.12.1</a></li><li><a tabindex="-1" href=/versions/0.11.0/>0.11.0</a></li></ul></li></ul>
</div>
<div class="plusIcon dropdown">
<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button"><span aria-hidden="true" class="glyphicon glyphicon-plus"></span></a>
<ul class="dropdown-menu dropdown-menu-right" id="plusMenu"></ul>
</div>
<div id="search-input-wrap">
<form action="../../search.html" autocomplete="off" class="" method="get" role="search">
<div class="form-group inner-addon left-addon">
<i class="glyphicon glyphicon-search"></i>
<input class="form-control" name="q" placeholder="Search" type="text"/>
</div>
<input name="check_keywords" type="hidden" value="yes">
<input name="area" type="hidden" value="default"/>
</input></form>
<div id="search-preview"></div>
</div>
<div id="searchIcon">
<span aria-hidden="true" class="glyphicon glyphicon-search"></span>
</div>
<!-- <div id="lang-select-wrap"> -->
<!--   <label id="lang-select-label"> -->
<!--     <\!-- <i class="fa fa-globe"></i> -\-> -->
<!--     <span></span> -->
<!--   </label> -->
<!--   <select id="lang-select"> -->
<!--     <option value="en">Eng</option> -->
<!--     <option value="zh">中文</option> -->
<!--   </select> -->
<!-- </div> -->
<!--     <a id="mobile-nav-toggle">
        <span class="mobile-nav-toggle-bar"></span>
        <span class="mobile-nav-toggle-bar"></span>
        <span class="mobile-nav-toggle-bar"></span>
      </a> -->
</div>
</div>
</div>
<script type="text/javascript">
        $('body').css('background', 'white');
    </script>
<div class="container">
<div class="row">
<div aria-label="main navigation" class="sphinxsidebar leftsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">MXNet APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/index.html">MXNet Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">MXNet Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">MXNet FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gluon/index.html">About Gluon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Installing MXNet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html#nvidia-jetson-tx-family">Nvidia Jetson TX family</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html#source-download">Source Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model_zoo/index.html">MXNet Model Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Tutorials</a></li>
</ul>
</div>
</div>
<div class="content">
<div class="page-tracker"></div>
<!--- Licensed to the Apache Software Foundation (ASF) under one -->
<!--- or more contributor license agreements.  See the NOTICE file -->
<!--- distributed with this work for additional information -->
<!--- regarding copyright ownership.  The ASF licenses this file -->
<!--- to you under the Apache License, Version 2.0 (the -->
<!--- "License"); you may not use this file except in compliance -->
<!--- with the License.  You may obtain a copy of the License at --><!---   http://www.apache.org/licenses/LICENSE-2.0 --><!--- Unless required by applicable law or agreed to in writing, -->
<!--- software distributed under the License is distributed on an -->
<!--- "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY -->
<!--- KIND, either express or implied.  See the License for the -->
<!--- specific language governing permissions and limitations -->
<!--- under the License. --><div class="section" id="types-of-data-augmentation">
<span id="types-of-data-augmentation"></span><h1>Types of Data Augmentation<a class="headerlink" href="#types-of-data-augmentation" title="Permalink to this headline">¶</a></h1>
<p>Data Augmentation is a regularization technique that’s used to avoid overfitting when training Machine Learning models. Although the technique can be applied in a variety of domains, it’s very common in Computer Vision, and this will be the focus of the tutorial.</p>
<p>Adjustments are made to the original images in the training dataset before being used in training. Some example adjustments include translating, croping, scaling, rotating, changing brightness and contrast. We do this to reduce the dependence of the model on spurious characteristics; e.g. training data may only contain faces that fill 1/4 of the image, so the model trainied without data augmentation might unhelpfully learn that faces can only be of this size.</p>
<p>After defining some utility functions to visualise the example images, this tutorial details each different augmentation that can be used to adjust both the position and the colors of images. We discuss augmentations that are combined into single functions, and conclude with a FAQ section.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">imshow</span>
<span class="kn">import</span> <span class="nn">mxnet</span> <span class="kn">as</span> <span class="nn">mx</span>  <span class="c1"># used version '1.0.0' at time of writing</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">mx</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># set seed for repeatability</span>
</pre></div>
</div>
<p>We define a utility function below, that will be used for visualising the augmentations in the tutorial.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_mx_array</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Array expected to be height x width x 3 (channels), and values are floats between 0 and 255.</span>
<span class="sd">    """</span>
    <span class="k">assert</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">"RGB Channel should be last"</span>
    <span class="n">imshow</span><span class="p">((</span><span class="n">array</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">())</span>
</pre></div>
</div>
<p>We load an example image, this will be the target for our augmentations in the tutorial.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">mx</span><span class="o">.</span><span class="n">test_utils</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">'https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/inputs/0.jpg'</span><span class="p">)</span>
<span class="n">example_image</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">"0.jpg"</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">example_image</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
</pre></div>
</div>
<p>You’ll notice that the image is loaded with with <code class="docutils literal"><span class="pre">numpy.int8</span></code> datatype. Some functions such as <code class="docutils literal"><span class="pre">swapaxes</span></code> don’t work on <code class="docutils literal"><span class="pre">int</span></code> types, so we’ll convert to <code class="docutils literal"><span class="pre">float32</span></code>, and visualize.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">example_image</span> <span class="o">=</span> <span class="n">example_image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"float32"</span><span class="p">)</span>    
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">example_image</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_8_0.png"><!--notebook-skip-line--></img></p>
</div>
<div class="section" id="position-augmentation">
<span id="position-augmentation"></span><h1>Position Augmentation<a class="headerlink" href="#position-augmentation" title="Permalink to this headline">¶</a></h1>
<p>One form of augmentation affects the position of pixel values. Using combinations of slicing, scaling, translating, rotating and fliping the values of the original image can be shifted to create new images. Some operations (like scaling and rotation) require interpolation as pixels in the new image are combinations of pixels in the original image.</p>
<div class="section" id="crop">
<span id="crop"></span><h2>Crop<a class="headerlink" href="#crop" title="Permalink to this headline">¶</a></h2>
<p>You can use <a class="reference external" href="/api/python/image/image.html?highlight=randomcropaug#mxnet.image.RandomCropAug"><code class="docutils literal"><span class="pre">mxnet.image.RandomCropAug</span></code></a> and <a class="reference external" href="/api/python/image/image.html?highlight=centercropaug#mxnet.image.CenterCropAug"><code class="docutils literal"><span class="pre">mxnet.image.CenterCropAug</span></code></a> to create instances of the Augmenter class, which can be called just like a function.</p>
<p>It’s worth noting that the randomisation for <code class="docutils literal"><span class="pre">RandomCropAug</span></code> happens when calling the Augmenter, and not at the point of instantiation. You’ll end up with different images each time you call the Augmenter, so it can’t be used to apply the same augmentation to another image. You can use <a class="reference external" href="/api/python/symbol/random.html?highlight=seed#mxnet.random.seed"><code class="docutils literal"><span class="pre">mxnet.random.seed</span></code></a> for random but repeatable augmentations.</p>
<p><code class="docutils literal"><span class="pre">CenterCropAug</span></code> is determanistic and just takes the most central crop of given size.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">RandomCropAug</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">example_image</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">427</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">aug_image</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_13_1.png"/><!--notebook-skip-line--></p>
<p><strong><em>Watch Out!</em></strong> Crop are a great way of adding diversity to your training examples, but be careful not to take it to the extreme. An example of this would be cropping out an object of interest from the image completely. Visualise a few examples after cropping to determine if this will be an issue.</p>
<p>If you’re training object detection models, it’s recommended that you use the <a class="reference external" href="/api/python/image/image.html?highlight=detrandomcropaug#mxnet.image.DetRandomCropAug"><code class="docutils literal"><span class="pre">mxnet.image.DetRandomCropAug</span></code></a> augmenter. Instead of the <code class="docutils literal"><span class="pre">size</span></code> parameter, it has parameters such as <code class="docutils literal"><span class="pre">min_object_covered</span></code> to prevent this issue.</p>
</div>
<div class="section" id="resize">
<span id="resize"></span><h2>Resize<a class="headerlink" href="#resize" title="Permalink to this headline">¶</a></h2>
<p>Use <a class="reference external" href="/api/python/image/image.html?highlight=resizeaug#mxnet.image.ResizeAug"><code class="docutils literal"><span class="pre">mxnet.image.ResizeAug</span></code></a> and <a class="reference external" href="/api/python/image/image.html?highlight=resizeaug#mxnet.image.ForceResizeAug"><code class="docutils literal"><span class="pre">mxnet.image.ForceResizeAug</span></code></a> for scaling the image.</p>
<p><code class="docutils literal"><span class="pre">mxnet.image.ResizeAug</span></code> scales the shortest edge to the defined size, and automatically adjusts the longest edge to maintain the aspect ratio of the input image.
<code class="docutils literal"><span class="pre">mxnet.image.ForceResizeAug</span></code> scales both height and width to the defined size, even if this doesn’t preserve the aspect ratio.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">ResizeAug</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">example_image</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">427</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">aug_image</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_17_1.png"/><!--notebook-skip-line--></p>
<p><strong><em>Watch out!</em></strong> <code class="docutils literal"><span class="pre">size</span></code> should be (width, height).</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">ForceResizeAug</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">example_image</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">427</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">aug_image</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_19_1.png"/><!--notebook-skip-line--></p>
</div>
<div class="section" id="horizontal-flip">
<span id="horizontal-flip"></span><h2>Horizontal Flip<a class="headerlink" href="#horizontal-flip" title="Permalink to this headline">¶</a></h2>
<p>Use <a class="reference external" href="/api/python/image/image.html?highlight=horizontalflipaug#mxnet.image.HorizontalFlipAug"><code class="docutils literal"><span class="pre">mxnet.image.HorizontalFlipAug</span></code></a> to flip the image horizontally, where <code class="docutils literal"><span class="pre">p</span></code> is the probability of a flip occurring.</p>
<p>We set <code class="docutils literal"><span class="pre">p=1</span></code> here to demonstration the effect, but in practice you’d choose a float between 0 and 1 (e.g. 0.5).</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">HorizontalFlipAug</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">example_image</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">427</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">aug_image</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">427</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_22_1.png"/><!--notebook-skip-line--></p>
<p>You can get a random vertical flip too using <a class="reference external" href="/api/python/ndarray/ndarray.html?highlight=swapaxes#mxnet.ndarray.NDArray.swapaxes"><code class="docutils literal"><span class="pre">mxnet.NDArray.swapaxes</span></code></a> (to switch height and width) before and after the random horizontal flip. Once again <code class="docutils literal"><span class="pre">p</span></code> will be the probability of a flip occurring, and is set to 1 for demonstration purposes.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">HorizontalFlipAug</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_24_0.png"/><!--notebook-skip-line--></p>
</div>
</div>
<div class="section" id="color-augmentation">
<span id="color-augmentation"></span><h1>Color Augmentation<a class="headerlink" href="#color-augmentation" title="Permalink to this headline">¶</a></h1>
<p>Another form of augmentation changes the pixel values, rather than the pixel positions. Since some of these functions don’t have obvious implentations, code snippets have been provided for most augmenters.</p>
<p><strong><em>Watch Out!</em></strong> Unlike with positional augmentation, the color augmentation functions edit the input images inplace.
So you’ll need to copy the image if you want to make augmentations on the same image independently.</p>
<div class="section" id="brightness">
<span id="brightness"></span><h2>Brightness<a class="headerlink" href="#brightness" title="Permalink to this headline">¶</a></h2>
<p>Use <a class="reference external" href="/api/python/image/image.html?highlight=brightnessjitteraug#mxnet.image.BrightnessJitterAug"><code class="docutils literal"><span class="pre">mxnet.image.mx.image.BrightnessJitterAug</span></code></a> to add a random brightness jitter to images. Use the <code class="docutils literal"><span class="pre">brightness</span></code> parameter to control the amount of jitter in brightness, with value from 0 (no change) to 1 (potentially large change). <code class="docutils literal"><span class="pre">brightness</span></code> doesn’t specify whether the brightness of the augmented image will be lighter or darker, just the potential strength of the effect. Specifically the augmentation is given by:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="n">brightness</span><span class="p">,</span> <span class="n">brightness</span><span class="p">)</span>
<span class="n">image</span> <span class="o">*=</span> <span class="n">alpha</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">example_image_copy</span> <span class="o">=</span> <span class="n">example_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">BrightnessJitterAug</span><span class="p">(</span><span class="n">brightness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image_copy</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_29_0.png"/><!--notebook-skip-line--></p>
</div>
<div class="section" id="contrast">
<span id="contrast"></span><h2>Contrast<a class="headerlink" href="#contrast" title="Permalink to this headline">¶</a></h2>
<p>Use <a class="reference external" href="/api/python/image/image.html?highlight=contrastjitteraug#mxnet.image.ContrastJitterAug"><code class="docutils literal"><span class="pre">mxnet.image.ContrastJitterAug</span></code></a> to add a random contrast jitter to an image. Contrast can be thought of as the degree to which light and dark colours in the image differ. Use the <code class="docutils literal"><span class="pre">contrast</span></code> parameter to control the amount of jitter in contrast, with value from 0 (no change) to 1 (potentially large change). <code class="docutils literal"><span class="pre">contrast</span></code> doesn’t specify whether the constrast of the augmented image will be higher or lower, just the potential strength of the effect. Specifically the augmentation is given by:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">coef</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">0.299</span><span class="p">,</span> <span class="mf">0.587</span><span class="p">,</span> <span class="mf">0.114</span><span class="p">]]])</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="n">contrast</span><span class="p">,</span> <span class="n">contrast</span><span class="p">)</span>
<span class="n">gray</span> <span class="o">=</span> <span class="n">image</span> <span class="o">*</span> <span class="n">coef</span>
<span class="n">gray</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">/</span> <span class="n">gray</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">*</span> <span class="n">nd</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">gray</span><span class="p">)</span>
<span class="n">image</span> <span class="o">*=</span> <span class="n">alpha</span>
<span class="n">image</span> <span class="o">+=</span> <span class="n">gray</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">example_image_copy</span> <span class="o">=</span> <span class="n">example_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">ContrastJitterAug</span><span class="p">(</span><span class="n">contrast</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image_copy</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_32_0.png"/> <!--notebook-skip-line--></p>
</div>
<div class="section" id="saturation">
<span id="saturation"></span><h2>Saturation<a class="headerlink" href="#saturation" title="Permalink to this headline">¶</a></h2>
<p>Use <a class="reference external" href="/api/python/image/image.html?highlight=image.saturationjitteraug#mxnet.image.SaturationJitterAug"><code class="docutils literal"><span class="pre">mxnet.image.SaturationJitterAug</span></code></a> to add a random saturation jitter to an image. Saturation can be thought of as the ‘amount’ of color in an image. Use the <code class="docutils literal"><span class="pre">saturation</span></code> parameter to control the amount of jitter in saturation, with value from 0 (no change) to 1 (potentially large change). <code class="docutils literal"><span class="pre">saturation</span></code> doesn’t specify whether the saturation of the augmented image will be higher or lower, just the potential strength of the effect. Specifically the augmentation is using the method detailed <a class="reference external" href="https://beesbuzz.biz/code/hsv_color_transforms.php">here</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">example_image_copy</span> <span class="o">=</span> <span class="n">example_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">SaturationJitterAug</span><span class="p">(</span><span class="n">saturation</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image_copy</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_35_0.png"/><!--notebook-skip-line--></p>
</div>
<div class="section" id="hue">
<span id="hue"></span><h2>Hue<a class="headerlink" href="#hue" title="Permalink to this headline">¶</a></h2>
<p>Use <a class="reference external" href="/api/python/image/image.html?highlight=huejitteraug#mxnet.image.HueJitterAug"><code class="docutils literal"><span class="pre">mxnet.image.HueJitterAug</span></code></a> to add a random hue jitter to images. Hue can be thought of as the ‘shade’ of the colors in an image. Use the <code class="docutils literal"><span class="pre">hue</span></code> parameter to control the amount of jitter in hue, with value from 0 (no change) to 1 (potentially large change). <code class="docutils literal"><span class="pre">hue</span></code> doesn’t specify whether the hue of the augmented image will be shifted one way or the other, just the potential strength of the effect. Specifically the augmentation is using the method detailed <a class="reference external" href="https://beesbuzz.biz/code/hsv_color_transforms.php">here</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">example_image_copy</span> <span class="o">=</span> <span class="n">example_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">HueJitterAug</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image_copy</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_38_0.png"/><!--notebook-skip-line--></p>
</div>
<div class="section" id="lightingaug">
<span id="lightingaug"></span><h2>LightingAug<a class="headerlink" href="#lightingaug" title="Permalink to this headline">¶</a></h2>
<p>Use <a class="reference external" href="/api/python/image/image.html?highlight=lightingaug#mxnet.image.LightingAug"><code class="docutils literal"><span class="pre">mxnet.image.LightingAug</span></code></a> to add PCA based noise, using the following method:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">alphastd</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="n">rgb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">eigvec</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">eigval</span><span class="p">)</span>
<span class="n">image</span> <span class="o">+=</span> <span class="n">nd</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rgb</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">example_image_copy</span> <span class="o">=</span> <span class="n">example_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">LightingAug</span><span class="p">(</span><span class="n">alphastd</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">eigval</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">eigvec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image_copy</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_41_0.png"/><!--notebook-skip-line--></p>
</div>
<div class="section" id="color-normalization">
<span id="color-normalization"></span><h2>Color Normalization<a class="headerlink" href="#color-normalization" title="Permalink to this headline">¶</a></h2>
<p>Given a per channel mean and standard deviation, <a class="reference external" href="/api/python/image/image.html?highlight=colornormalizeaug#mxnet.image.ColorNormalizeAug"><code class="docutils literal"><span class="pre">mxnet.image.ColorNormalizeAug</span></code></a> will normalise the values on each channel, as given by:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">mean</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">image</span> <span class="o">-=</span> <span class="n">mean</span>
<span class="k">if</span> <span class="n">std</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">image</span> <span class="o">/=</span> <span class="n">std</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">example_image_copy</span> <span class="o">=</span> <span class="n">example_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">mean</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">stdev</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<p>If you calculate the true mean of the image, each channel in the output will be 0 centered. And if you calculate the true standard deviation, each channel in the output will have unit variance. Some arbritary mean and stdev values have been picked for demonstration.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">ColorNormalizeAug</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="n">stdev</span><span class="p">)</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image_copy</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_46_0.png"/><!--notebook-skip-line--></p>
</div>
<div class="section" id="grayscale">
<span id="grayscale"></span><h2>Grayscale<a class="headerlink" href="#grayscale" title="Permalink to this headline">¶</a></h2>
<p>Use <a class="reference external" href="/api/python/image/image.html?highlight=randomgrayaug#mxnet.image.RandomGrayAug"><code class="docutils literal"><span class="pre">mxnet.image.RandomGrayAug</span></code></a> to randomly remove the color from the image. <code class="docutils literal"><span class="pre">p</span></code> is the probability of a greyscale occuring.</p>
<p>We set <code class="docutils literal"><span class="pre">p=1</span></code> here to demonstration the effect, but in practice you’d choose a float between 0 and 1 (e.g. 0.5).</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">example_image_copy</span> <span class="o">=</span> <span class="n">example_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">RandomGrayAug</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image_copy</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_49_0.png"/><!--notebook-skip-line--></p>
</div>
</div>
<div class="section" id="combinations">
<span id="combinations"></span><h1>Combinations<a class="headerlink" href="#combinations" title="Permalink to this headline">¶</a></h1>
<p>Some shortcut functions are provided to perform multiple augmentation in a single function.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># A random crop, with a random resizing, and random aspect ratio jitter</span>
<span class="n">example_image_copy</span> <span class="o">=</span> <span class="n">example_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">RandomSizedCropAug</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">area</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">))</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image_copy</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">aug_image</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_52_0.png"/><!--notebook-skip-line--></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># A random brightness, contrast and saturation jitter in random order.</span>
<span class="n">example_image_copy</span> <span class="o">=</span> <span class="n">example_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">ColorJitterAug</span><span class="p">(</span><span class="n">brightness</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">saturation</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image_copy</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_53_0.png"/><!--notebook-skip-line--></p>
<p>And lastly, you can use <a class="reference external" href="/api/python/image/image.html#mxnet.image.RandomOrderAug"><code class="docutils literal"><span class="pre">mxnet.image.RandomOrderAug</span></code></a> to apply multiple augmenters to an image, in a random order.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">example_image_copy</span> <span class="o">=</span> <span class="n">example_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">aug_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">RandomCropAug</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)),</span>
    <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">HorizontalFlipAug</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">BrightnessJitterAug</span><span class="p">(</span><span class="n">brightness</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">HueJitterAug</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">aug</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">RandomOrderAug</span><span class="p">(</span><span class="n">aug_list</span><span class="p">)</span>
<span class="n">aug_image</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">example_image_copy</span><span class="p">)</span>
<span class="n">plot_mx_array</span><span class="p">(</span><span class="n">aug_image</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">aug_image</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/doc/tutorials/data_aug/outputs/types_of/output_55_0.png"/><!--notebook-skip-line--></p>
</div>
<div class="section" id="faqs">
<span id="faqs"></span><h1>FAQs<a class="headerlink" href="#faqs" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-shape-should-arrays-images-be-when-using-augmenters">
<span id="what-shape-should-arrays-images-be-when-using-augmenters"></span><h2>1) What shape should arrays/images be when using Augmenters?<a class="headerlink" href="#what-shape-should-arrays-images-be-when-using-augmenters" title="Permalink to this headline">¶</a></h2>
<p>Augmenters work with arrays of shape <code class="docutils literal"><span class="pre">height</span></code> x <code class="docutils literal"><span class="pre">width</span></code> x <code class="docutils literal"><span class="pre">channel</span></code>.</p>
<p>When working with <code class="docutils literal"><span class="pre">ImageIter</span></code>s such as <a class="reference external" href="/api/python/image/image.html#mxnet.image.ImageIter"><code class="docutils literal"><span class="pre">mxnet.image.ImageIter</span></code></a>, you should perform the augmentations while iterating, rather than on the output of the iterator. <code class="docutils literal"><span class="pre">ImageIter</span></code> return images of shape <code class="docutils literal"><span class="pre">3</span></code> x <code class="docutils literal"><span class="pre">height</span></code> x <code class="docutils literal"><span class="pre">width</span></code>, so you would have to use <a class="reference external" href="/api/python/ndarray/ndarray.html?highlight=swapaxes#mxnet.ndarray.NDArray.swapaxes"><code class="docutils literal"><span class="pre">mxnet.NDArray.swapaxes</span></code></a> before applying Augmenters; hence why this later approach is not recommended. You can instead specify the augmentation steps in the constructor of the <code class="docutils literal"><span class="pre">ImageIter</span></code>, using the <code class="docutils literal"><span class="pre">aug_list</span></code> argument or <code class="docutils literal"><span class="pre">**kwargs</span></code>, and the dimension ordering will be handled for you.</p>
<p><strong>Note</strong>: Some implicit augmentation may occur when using <code class="docutils literal"><span class="pre">ImageIter</span></code>. You must specify the <code class="docutils literal"><span class="pre">data_shape</span></code> in the constructor of the <code class="docutils literal"><span class="pre">ImageIter</span></code>, and if the height and width are different from the image source, it crops and/or scales. Scaling is applied equally in both height and width axes so image isn’t streched.</p>
</div>
<div class="section" id="what-channel-order-should-be-used-when-using-augmenters">
<span id="what-channel-order-should-be-used-when-using-augmenters"></span><h2>2) What channel order should be used when using Augmenters?<a class="headerlink" href="#what-channel-order-should-be-used-when-using-augmenters" title="Permalink to this headline">¶</a></h2>
<p>MXNet’s default is Red, Green, Blue (RGB), while OpenCV’s default is Blue, Green, Red (BGR).</p>
</div>
<div class="section" id="what-value-ranges-should-be-used-when-using-augmenters">
<span id="what-value-ranges-should-be-used-when-using-augmenters"></span><h2>3) What value ranges should be used when using Augmenters?<a class="headerlink" href="#what-value-ranges-should-be-used-when-using-augmenters" title="Permalink to this headline">¶</a></h2>
<p>Most Augmenters don’t require values of a certain range. Some Augmenters (such as <code class="docutils literal"><span class="pre">mxnet.image.ResizeAug</span></code> and <code class="docutils literal"><span class="pre">mxnet.image.BrightnessJitterAug</span></code>) can output images with a larger value range than the input though. An example of this would be an image with values 0 to 255, where pixels already close to the range boundary might be shifted outside of the 0 to 255 range by a random brightness jitter. You’ll notice that the <code class="docutils literal"><span class="pre">plot_mx_array</span></code> function clips values outside of the 0 to 255 range.</p>
</div>
<div class="section" id="are-augmentations-performed-on-gpu">
<span id="are-augmentations-performed-on-gpu"></span><h2>4) Are augmentations performed on GPU?<a class="headerlink" href="#are-augmentations-performed-on-gpu" title="Permalink to this headline">¶</a></h2>
<p>Most of the augmenters contain a mixture of control logic and <code class="docutils literal"><span class="pre">NDArray</span></code> operations. Although <code class="docutils literal"><span class="pre">NDArray</span></code> operations can be run on GPU, the control logic will still run on CPU which may limit performance. With Gluon DataLoaders you can specify <code class="docutils literal"><span class="pre">num_workers</span></code> to perform loading and augmentation in parallel with multiprocessing workers.</p>
</div>
<div class="section" id="can-i-implement-custom-augmentations">
<span id="can-i-implement-custom-augmentations"></span><h2>4) Can I implement custom augmentations?<a class="headerlink" href="#can-i-implement-custom-augmentations" title="Permalink to this headline">¶</a></h2>
<p>Yes, you can implement your own class that inherits from <a class="reference external" href="/api/python/image/image.html?highlight=augmenter#mxnet.image.Augmenter"><code class="docutils literal"><span class="pre">Augmenter</span></code></a> and define the augmentation steps in the <code class="docutils literal"><span class="pre">__call__</span></code> method. You can also implement a <code class="docutils literal"><span class="pre">dumps</span></code> method which returns a string representation of the augmenter and its parameters: it’s used when inspecting a list of <code class="docutils literal"><span class="pre">Augmenter</span></code>s.</p>
<div class="btn-group" role="group">
<div class="download-btn"><a download="types_of_data_augmentation.ipynb" href="types_of_data_augmentation.ipynb"><span class="glyphicon glyphicon-download-alt"></span> types_of_data_augmentation.ipynb</a></div></div></div>
</div>
</div>
</div>
<div aria-label="main navigation" class="sphinxsidebar rightsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li><a class="reference internal" href="#">Types of Data Augmentation</a></li>
<li><a class="reference internal" href="#position-augmentation">Position Augmentation</a><ul>
<li><a class="reference internal" href="#crop">Crop</a></li>
<li><a class="reference internal" href="#resize">Resize</a></li>
<li><a class="reference internal" href="#horizontal-flip">Horizontal Flip</a></li>
</ul>
</li>
<li><a class="reference internal" href="#color-augmentation">Color Augmentation</a><ul>
<li><a class="reference internal" href="#brightness">Brightness</a></li>
<li><a class="reference internal" href="#contrast">Contrast</a></li>
<li><a class="reference internal" href="#saturation">Saturation</a></li>
<li><a class="reference internal" href="#hue">Hue</a></li>
<li><a class="reference internal" href="#lightingaug">LightingAug</a></li>
<li><a class="reference internal" href="#color-normalization">Color Normalization</a></li>
<li><a class="reference internal" href="#grayscale">Grayscale</a></li>
</ul>
</li>
<li><a class="reference internal" href="#combinations">Combinations</a></li>
<li><a class="reference internal" href="#faqs">FAQs</a><ul>
<li><a class="reference internal" href="#what-shape-should-arrays-images-be-when-using-augmenters">1) What shape should arrays/images be when using Augmenters?</a></li>
<li><a class="reference internal" href="#what-channel-order-should-be-used-when-using-augmenters">2) What channel order should be used when using Augmenters?</a></li>
<li><a class="reference internal" href="#what-value-ranges-should-be-used-when-using-augmenters">3) What value ranges should be used when using Augmenters?</a></li>
<li><a class="reference internal" href="#are-augmentations-performed-on-gpu">4) Are augmentations performed on GPU?</a></li>
<li><a class="reference internal" href="#can-i-implement-custom-augmentations">4) Can I implement custom augmentations?</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div><div class="footer">
<div class="section-disclaimer">
<div class="container">
<div>
<img height="60" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/apache_incubator_logo.png"/>
<p>
            Apache MXNet is an effort undergoing incubation at The Apache Software Foundation (ASF), <strong>sponsored by the <i>Apache Incubator</i></strong>. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
        </p>
<p>
            "Copyright © 2017-2018, The Apache Software Foundation
            Apache MXNet, MXNet, Apache, the Apache feather, and the Apache MXNet project logo are either registered trademarks or trademarks of the Apache Software Foundation."
        </p>
</div>
</div>
</div>
</div> <!-- pagename != index -->
</div>
<script crossorigin="anonymous" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="../../_static/js/sidebar.js" type="text/javascript"></script>
<script src="../../_static/js/search.js" type="text/javascript"></script>
<script src="../../_static/js/navbar.js" type="text/javascript"></script>
<script src="../../_static/js/clipboard.min.js" type="text/javascript"></script>
<script src="../../_static/js/copycode.js" type="text/javascript"></script>
<script src="../../_static/js/page.js" type="text/javascript"></script>
<script src="../../_static/js/docversion.js" type="text/javascript"></script>
<script type="text/javascript">
        $('body').ready(function () {
            $('body').css('visibility', 'visible');
        });
    </script>
</body>
</html>