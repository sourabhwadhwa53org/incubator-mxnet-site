<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="NDArray: Vectorized Tensor Computations on CPUs and GPUs" property="og:title">
<meta content="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/og-logo.png" property="og:image">
<meta content="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/og-logo.png" property="og:image:secure_url">
<meta content="NDArray: Vectorized Tensor Computations on CPUs and GPUs" property="og:description"/>
<title>NDArray: Vectorized Tensor Computations on CPUs and GPUs — mxnet  documentation</title>
<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" rel="stylesheet"/>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet"/>
<link href="../../_static/basic.css" rel="stylesheet" type="text/css">
<link href="../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../_static/mxnet.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
<script src="https://code.jquery.com/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="../../_static/underscore.js" type="text/javascript"></script>
<script src="../../_static/searchtools_custom.js" type="text/javascript"></script>
<script src="../../_static/doctools.js" type="text/javascript"></script>
<script src="../../_static/selectlang.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script type="text/javascript"> jQuery(function() { Search.loadIndex("/searchindex.js"); Search.init();}); </script>
<script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
      Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-96378503-1', 'auto');
      ga('send', 'pageview');

    </script>
<!-- -->
<!-- <script type="text/javascript" src="../../_static/jquery.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="../../_static/underscore.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="../../_static/doctools.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
<!-- -->
<link href="../../genindex.html" rel="index" title="Index">
<link href="../../search.html" rel="search" title="Search"/>
<link href="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet-icon.png" rel="icon" type="image/png"/>
</link></link></link></meta></meta></meta></head>
<body background="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet-background-compressed.jpeg" role="document">
<div class="content-block"><div class="navbar navbar-fixed-top">
<div class="container" id="navContainer">
<div class="innder" id="header-inner">
<h1 id="logo-wrap">
<a href="../../" id="logo"><img src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet_logo.png"/></a>
</h1>
<nav class="nav-bar" id="main-nav">
<a class="main-nav-link" href="../../install/index.html">Install</a>
<span id="dropdown-menu-position-anchor">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Gluon <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu">
<li><a class="main-nav-link" href="../../gluon/index.html">About</a></li>
<li><a class="main-nav-link" href="https://www.d2l.ai/">Dive into Deep Learning</a></li>
<li><a class="main-nav-link" href="https://gluon-cv.mxnet.io">GluonCV Toolkit</a></li>
<li><a class="main-nav-link" href="https://gluon-nlp.mxnet.io/">GluonNLP Toolkit</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">API <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu">
<li><a class="main-nav-link" href="../../api/python/index.html">Python</a></li>
<li><a class="main-nav-link" href="../../api/c++/index.html">C++</a></li>
<li><a class="main-nav-link" href="../../api/clojure/index.html">Clojure</a></li>
<li><a class="main-nav-link" href="../../api/java/index.html">Java</a></li>
<li><a class="main-nav-link" href="../../api/julia/index.html">Julia</a></li>
<li><a class="main-nav-link" href="../../api/perl/index.html">Perl</a></li>
<li><a class="main-nav-link" href="../../api/r/index.html">R</a></li>
<li><a class="main-nav-link" href="../../api/scala/index.html">Scala</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor-docs">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Docs <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu-docs">
<li><a class="main-nav-link" href="../../faq/index.html">FAQ</a></li>
<li><a class="main-nav-link" href="../../tutorials/index.html">Tutorials</a>
<li><a class="main-nav-link" href="https://github.com/apache/incubator-mxnet/tree/master/example">Examples</a></li>
<li><a class="main-nav-link" href="../../architecture/index.html">Architecture</a></li>
<li><a class="main-nav-link" href="https://cwiki.apache.org/confluence/display/MXNET/Apache+MXNet+Home">Developer Wiki</a></li>
<li><a class="main-nav-link" href="../../api/python/gluon/model_zoo.html">Model Zoo</a></li>
<li><a class="main-nav-link" href="../../api/python/contrib/onnx.html">ONNX</a></li>
</li></ul>
</span>
<span id="dropdown-menu-position-anchor-community">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Community <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu-community">
<li><a class="main-nav-link" href="http://discuss.mxnet.io">Forum</a></li>
<li><a class="main-nav-link" href="https://github.com/apache/incubator-mxnet">Github</a></li>
<li><a class="main-nav-link" href="../../community/contribute.html">Contribute</a></li>
<li><a class="main-nav-link" href="../../community/ecosystem.html">Ecosystem</a></li>
<li><a class="main-nav-link" href="../../community/powered_by.html">Powered By</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor-version" style="position: relative"><a href="#" class="main-nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true">Versions(1.3.1)<span class="caret"></span></a><ul id="package-dropdown-menu" class="dropdown-menu"><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.5.0/index.html>1.5.0</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.4.1/index.html>1.4.1</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.3.1/index.html>1.3.1</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.2.1/index.html>1.2.1</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.1.0/index.html>1.1.0</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.0.0/index.html>1.0.0</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/0.12.1/index.html>0.12.1</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/0.11.0/index.html>0.11.0</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/master/index.html>master</a></li></ul></span></nav>
<script> function getRootPath(){ return "../../" } </script>
<div class="burgerIcon dropdown">
<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">☰</a>
<ul class="dropdown-menu" id="burgerMenu">
<li><a href="../../install/index.html">Install</a></li>
<li><a class="main-nav-link" href="../../tutorials/index.html">Tutorials</a></li>
<li class="dropdown-submenu dropdown">
<a aria-expanded="true" aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" tabindex="-1">Gluon</a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu">
<li><a class="main-nav-link" href="../../gluon/index.html">About</a></li>
<li><a class="main-nav-link" href="http://gluon.mxnet.io">The Straight Dope (Tutorials)</a></li>
<li><a class="main-nav-link" href="https://gluon-cv.mxnet.io">GluonCV Toolkit</a></li>
<li><a class="main-nav-link" href="https://gluon-nlp.mxnet.io/">GluonNLP Toolkit</a></li>
</ul>
</li>
<li class="dropdown-submenu">
<a aria-expanded="true" aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" tabindex="-1">API</a>
<ul class="dropdown-menu">
<li><a class="main-nav-link" href="../../api/python/index.html">Python</a></li>
<li><a class="main-nav-link" href="../../api/c++/index.html">C++</a></li>
<li><a class="main-nav-link" href="../../api/clojure/index.html">Clojure</a></li>
<li><a class="main-nav-link" href="../../api/java/index.html">Java</a></li>
<li><a class="main-nav-link" href="../../api/julia/index.html">Julia</a></li>
<li><a class="main-nav-link" href="../../api/perl/index.html">Perl</a></li>
<li><a class="main-nav-link" href="../../api/r/index.html">R</a></li>
<li><a class="main-nav-link" href="../../api/scala/index.html">Scala</a></li>
</ul>
</li>
<li class="dropdown-submenu">
<a aria-expanded="true" aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" tabindex="-1">Docs</a>
<ul class="dropdown-menu">
<li><a href="../../faq/index.html" tabindex="-1">FAQ</a></li>
<li><a href="../../tutorials/index.html" tabindex="-1">Tutorials</a></li>
<li><a href="https://github.com/apache/incubator-mxnet/tree/master/example" tabindex="-1">Examples</a></li>
<li><a href="../../architecture/index.html" tabindex="-1">Architecture</a></li>
<li><a href="https://cwiki.apache.org/confluence/display/MXNET/Apache+MXNet+Home" tabindex="-1">Developer Wiki</a></li>
<li><a href="../../api/python/gluon/model_zoo.html" tabindex="-1">Gluon Model Zoo</a></li>
<li><a href="../../api/python/contrib/onnx.html" tabindex="-1">ONNX</a></li>
</ul>
</li>
<li class="dropdown-submenu dropdown">
<a aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" role="button" tabindex="-1">Community</a>
<ul class="dropdown-menu">
<li><a href="http://discuss.mxnet.io" tabindex="-1">Forum</a></li>
<li><a href="https://github.com/apache/incubator-mxnet" tabindex="-1">Github</a></li>
<li><a href="../../community/contribute.html" tabindex="-1">Contribute</a></li>
<li><a href="../../community/ecosystem.html" tabindex="-1">Ecosystem</a></li>
<li><a href="../../community/powered_by.html" tabindex="-1">Powered By</a></li>
</ul>
</li>
<li id="dropdown-menu-position-anchor-version-mobile" class="dropdown-submenu" style="position: relative"><a href="#" tabindex="-1">Versions(1.3.1)</a><ul class="dropdown-menu"><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.5.0/index.html>1.5.0</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.4.1/index.html>1.4.1</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.3.1/index.html>1.3.1</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.2.1/index.html>1.2.1</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.1.0/index.html>1.1.0</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.0.0/index.html>1.0.0</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/0.12.1/index.html>0.12.1</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/0.11.0/index.html>0.11.0</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/master/index.html>master</a></li></ul></li></ul>
</div>
<div class="plusIcon dropdown">
<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button"><span aria-hidden="true" class="glyphicon glyphicon-plus"></span></a>
<ul class="dropdown-menu dropdown-menu-right" id="plusMenu"></ul>
</div>
<div id="search-input-wrap">
<form action="../../search.html" autocomplete="off" class="" method="get" role="search">
<div class="form-group inner-addon left-addon">
<i class="glyphicon glyphicon-search"></i>
<input class="form-control" name="q" placeholder="Search" type="text"/>
</div>
<input name="check_keywords" type="hidden" value="yes">
<input name="area" type="hidden" value="default"/>
</input></form>
<div id="search-preview"></div>
</div>
<div id="searchIcon">
<span aria-hidden="true" class="glyphicon glyphicon-search"></span>
</div>
<!-- <div id="lang-select-wrap"> -->
<!--   <label id="lang-select-label"> -->
<!--     <\!-- <i class="fa fa-globe"></i> -\-> -->
<!--     <span></span> -->
<!--   </label> -->
<!--   <select id="lang-select"> -->
<!--     <option value="en">Eng</option> -->
<!--     <option value="zh">中文</option> -->
<!--   </select> -->
<!-- </div> -->
<!--     <a id="mobile-nav-toggle">
        <span class="mobile-nav-toggle-bar"></span>
        <span class="mobile-nav-toggle-bar"></span>
        <span class="mobile-nav-toggle-bar"></span>
      </a> -->
</div>
</div>
</div>
<script type="text/javascript">
        $('body').css('background', 'white');
    </script>
<div class="container">
<div class="row">
<div aria-label="main navigation" class="sphinxsidebar leftsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/python/index.html">Python Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/r/index.html">R Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/julia/index.html">Julia Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/c++/index.html">C++ Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/scala/index.html">Scala Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/perl/index.html">Perl Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">HowTo Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/index.html">System Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/contribute.html">Community</a></li>
</ul>
</div>
</div>
<div class="content">
<div class="page-tracker"></div>
<div class="section" id="ndarray-vectorized-tensor-computations-on-cpus-and-gpus">
<span id="ndarray-vectorized-tensor-computations-on-cpus-and-gpus"></span><h1>NDArray: Vectorized Tensor Computations on CPUs and GPUs<a class="headerlink" href="#ndarray-vectorized-tensor-computations-on-cpus-and-gpus" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">NDArray</span></code> is the basic vectorized operation unit in MXNet for matrix and tensor computations.
Users can perform usual calculations as on an R”s array, but with two additional features:</p>
<ul class="simple">
<li>Multiple devices: All operations can be run on various devices including
CPUs and GPUs.</li>
</ul>
<ul class="simple">
<li>Automatic parallelization: All operations are automatically executed in
parallel with each other.</li>
</ul>
<div class="section" id="create-and-initialize">
<span id="create-and-initialize"></span><h2>Create and Initialize<a class="headerlink" href="#create-and-initialize" title="Permalink to this headline">¶</a></h2>
<p>Let”s create <code class="docutils literal"><span class="pre">NDArray</span></code> on either a GPU or a CPU:</p>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="nf">require</span><span class="p">(</span><span class="n">mxnet</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">## Loading required package: mxnet</span>
<span class="c1">## Loading required package: methods</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o"><-</span> <span class="nf">mx.nd.zeros</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">))</span> <span class="c1"># create a 2-by-3 matrix on cpu</span>
<span class="n">b</span> <span class="o"><-</span> <span class="nf">mx.nd.zeros</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span> <span class="nf">mx.cpu</span><span class="p">())</span> <span class="c1"># create a 2-by-3 matrix on cpu</span>
<span class="c1"># c <- mx.nd.zeros(c(2, 3), mx.gpu(0)) # create a 2-by-3 matrix on gpu 0, if you have CUDA enabled.</span>
</pre></div>
</div>
<p>Typically for CUDA-enabled devices, the device id of a GPU starts from 0.
That’s why we passed in 0 to the GPU id.</p>
<p>We can initialize an <code class="docutils literal"><span class="pre">NDArray</span></code> object in various ways:</p>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o"><-</span> <span class="nf">mx.nd.ones</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="m">4</span><span class="p">))</span>
<span class="n">b</span> <span class="o"><-</span> <span class="nf">mx.rnorm</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">))</span>
<span class="n">c</span> <span class="o"><-</span> <span class="nf">mx.nd.array</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>
</pre></div>
</div>
<p>To check the numbers in an <code class="docutils literal"><span class="pre">NDArray</span></code>, we can simply run:</p>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o"><-</span> <span class="nf">mx.nd.ones</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">))</span>
<span class="n">b</span> <span class="o"><-</span> <span class="nf">as.array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nf">class</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">## [1] "matrix"</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="n">b</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">##      [,1] [,2] [,3]</span>
<span class="c1">## [1,]    1    1    1</span>
<span class="c1">## [2,]    1    1    1</span>
</pre></div>
</div>
</div>
<div class="section" id="performing-basic-operations">
<span id="performing-basic-operations"></span><h2>Performing Basic Operations<a class="headerlink" href="#performing-basic-operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="elemental-wise-operations">
<span id="elemental-wise-operations"></span><h3>Elemental-wise Operations<a class="headerlink" href="#elemental-wise-operations" title="Permalink to this headline">¶</a></h3>
<p>You can perform elemental-wise operations on <code class="docutils literal"><span class="pre">NDArray</span></code> objects, as follows:</p>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o"><-</span> <span class="nf">mx.nd.ones</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">))</span> <span class="o">*</span> <span class="m">2</span>
<span class="n">b</span> <span class="o"><-</span> <span class="nf">mx.nd.ones</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">))</span> <span class="o">/</span> <span class="m">8</span>
<span class="nf">as.array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">##      [,1] [,2] [,3] [,4]</span>
<span class="c1">## [1,]    2    2    2    2</span>
<span class="c1">## [2,]    2    2    2    2</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="nf">as.array</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">##       [,1]  [,2]  [,3]  [,4]</span>
<span class="c1">## [1,] 0.125 0.125 0.125 0.125</span>
<span class="c1">## [2,] 0.125 0.125 0.125 0.125</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o"><-</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="nf">as.array</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">##       [,1]  [,2]  [,3]  [,4]</span>
<span class="c1">## [1,] 2.125 2.125 2.125 2.125</span>
<span class="c1">## [2,] 2.125 2.125 2.125 2.125</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o"><-</span> <span class="n">c</span> <span class="o">/</span> <span class="n">a</span> <span class="o">-</span> <span class="m">5</span>
<span class="nf">as.array</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">##         [,1]    [,2]    [,3]    [,4]</span>
<span class="c1">## [1,] -3.9375 -3.9375 -3.9375 -3.9375</span>
<span class="c1">## [2,] -3.9375 -3.9375 -3.9375 -3.9375</span>
</pre></div>
</div>
<p>If two <code class="docutils literal"><span class="pre">NDArray</span></code>s are located on different devices, we need to explicitly move them to the same one. For instance:</p>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o"><-</span> <span class="nf">mx.nd.ones</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">))</span> <span class="o">*</span> <span class="m">2</span>
<span class="n">b</span> <span class="o"><-</span> <span class="nf">mx.nd.ones</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span> <span class="nf">mx.gpu</span><span class="p">())</span> <span class="o">/</span> <span class="m">8</span>
<span class="n">c</span> <span class="o"><-</span> <span class="nf">mx.nd.copyto</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nf">mx.gpu</span><span class="p">())</span> <span class="o">*</span> <span class="n">b</span>
<span class="nf">as.array</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="loading-and-saving">
<span id="loading-and-saving"></span><h3>Loading and Saving<a class="headerlink" href="#loading-and-saving" title="Permalink to this headline">¶</a></h3>
<p>You can save a list of <code class="docutils literal"><span class="pre">NDArray</span></code> object to your disk with <code class="docutils literal"><span class="pre">mx.nd.save</span></code>:</p>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o"><-</span> <span class="nf">mx.nd.ones</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">))</span>
<span class="nf">mx.nd.save</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">"temp.ndarray"</span><span class="p">)</span>
</pre></div>
</div>
<p>You can load it back easily:</p>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o"><-</span> <span class="nf">mx.nd.load</span><span class="p">(</span><span class="s">"temp.ndarray"</span><span class="p">)</span>
<span class="nf">as.array</span><span class="p">(</span><span class="n">a[[1]]</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">##      [,1] [,2] [,3]</span>
<span class="c1">## [1,]    1    1    1</span>
<span class="c1">## [2,]    1    1    1</span>
</pre></div>
</div>
<p>We can directly save data to and load it from a distributed file system, such as Amazon S3 and HDFS:</p>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="nf">mx.nd.save</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">"s3://mybucket/mydata.bin"</span><span class="p">)</span>
<span class="nf">mx.nd.save</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">"hdfs///users/myname/mydata.bin"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="automatic-parallelization">
<span id="automatic-parallelization"></span><h2>Automatic Parallelization<a class="headerlink" href="#automatic-parallelization" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">NDArray</span></code> can automatically execute operations in parallel. Automatic parallelization is useful when
using multiple resources, such as CPU cards, GPU cards, and CPU-to-GPU memory bandwidth.</p>
<p>For example, if we write <code class="docutils literal"><span class="pre">a</span> <span class="pre"><-</span> <span class="pre">a</span> <span class="pre">+</span> <span class="pre">1</span></code> followed by <code class="docutils literal"><span class="pre">b</span> <span class="pre"><-</span> <span class="pre">b</span> <span class="pre">+</span> <span class="pre">1</span></code>, and <code class="docutils literal"><span class="pre">a</span></code> is on a CPU and
<code class="docutils literal"><span class="pre">b</span></code> is on a GPU, executing them in parallel improves
efficiency. Furthermore, because copying data between CPUs and GPUs are also expensive, running in parallel with other computations further increases efficiency.</p>
<p>It’s hard to find the code that can be executed in parallel by eye. In the
following example, <code class="docutils literal"><span class="pre">a</span> <span class="pre"><-</span> <span class="pre">a</span> <span class="pre">+</span> <span class="pre">1</span></code> and <code class="docutils literal"><span class="pre">c</span> <span class="pre"><-</span> <span class="pre">c</span> <span class="pre">*</span> <span class="pre">3</span></code> can be executed in parallel, but <code class="docutils literal"><span class="pre">a</span> <span class="pre"><-</span> <span class="pre">a</span> <span class="pre">+</span> <span class="pre">1</span></code> and
<code class="docutils literal"><span class="pre">b</span> <span class="pre"><-</span> <span class="pre">b</span> <span class="pre">*</span> <span class="pre">3</span></code> should be in sequential.</p>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o"><-</span> <span class="nf">mx.nd.ones</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
<span class="n">b</span> <span class="o"><-</span> <span class="n">a</span>
<span class="n">c</span> <span class="o"><-</span> <span class="nf">mx.nd.copyto</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nf">mx.cpu</span><span class="p">())</span>
<span class="n">a</span> <span class="o"><-</span> <span class="n">a</span> <span class="o">+</span> <span class="m">1</span>
<span class="n">b</span> <span class="o"><-</span> <span class="n">b</span> <span class="o">*</span> <span class="m">3</span>
<span class="n">c</span> <span class="o"><-</span> <span class="n">c</span> <span class="o">*</span> <span class="m">3</span>
</pre></div>
</div>
<p>Luckily, MXNet can automatically resolve the dependencies and
execute operations in parallel accurately. This allows us to write our program assuming there is only a single thread. MXNet will
automatically dispatch the program to multiple devices.</p>
<p>MXNet achieves this with lazy evaluation. Each operation is issued to an
internal engine, and then returned. For example, if we run <code class="docutils literal"><span class="pre">a</span> <span class="pre"><-</span> <span class="pre">a</span> <span class="pre">+</span> <span class="pre">1</span></code>, it
returns immediately after pushing the plus operator to the engine. This
asynchronous processing allows us to push more operators to the engine. It determines
the read and write dependencies and the best way to execute them in
parallel.</p>
<p>The actual computations are finished, allowing us to copy the results someplace else, such as <code class="docutils literal"><span class="pre">as.array(a)</span></code> or <code class="docutils literal"><span class="pre">mx.nd.save(a,</span> <span class="pre">"temp.dat")</span></code>. To write highly parallelized codes, we only need to postpone when we need
the results.</p>
</div>
<div class="section" id="next-steps">
<span id="next-steps"></span><h2>Next Steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference external" href="https://mxnet.incubator.apache.org/versions/1.3.1/tutorials/r/symbol.html">Symbol</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mxnet.incubator.apache.org/versions/1.3.1/tutorials/r/CallbackFunction.html">Write and use callback functions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mxnet.incubator.apache.org/versions/1.3.1/tutorials/r/fiveMinutesNeuralNetwork.html">Neural Networks with MXNet in Five Minutes</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mxnet.incubator.apache.org/versions/1.3.1/tutorials/r/classifyRealImageWithPretrainedModel.html">Classify Real-World Images with Pre-trained Model</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mxnet.incubator.apache.org/versions/1.3.1/tutorials/r/mnistCompetition.html">Handwritten Digits Classification Competition</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mxnet.incubator.apache.org/versions/1.3.1/tutorials/r/charRnnModel.html">Character Language Model using RNN</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div aria-label="main navigation" class="sphinxsidebar rightsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li><a class="reference internal" href="#">NDArray: Vectorized Tensor Computations on CPUs and GPUs</a><ul>
<li><a class="reference internal" href="#create-and-initialize">Create and Initialize</a></li>
<li><a class="reference internal" href="#performing-basic-operations">Performing Basic Operations</a><ul>
<li><a class="reference internal" href="#elemental-wise-operations">Elemental-wise Operations</a></li>
<li><a class="reference internal" href="#loading-and-saving">Loading and Saving</a></li>
</ul>
</li>
<li><a class="reference internal" href="#automatic-parallelization">Automatic Parallelization</a></li>
<li><a class="reference internal" href="#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div><div class="footer">
<div class="section-disclaimer">
<div class="container">
<div>
<img height="60" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/apache_incubator_logo.png"/>
<p>
            Apache MXNet is an effort undergoing incubation at The Apache Software Foundation (ASF), <strong>sponsored by the <i>Apache Incubator</i></strong>. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
        </p>
<p>
            "Copyright © 2017-2018, The Apache Software Foundation
            Apache MXNet, MXNet, Apache, the Apache feather, and the Apache MXNet project logo are either registered trademarks or trademarks of the Apache Software Foundation."
        </p>
</div>
</div>
</div>
</div> <!-- pagename != index -->
</div>
<script crossorigin="anonymous" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="../../_static/js/sidebar.js" type="text/javascript"></script>
<script src="../../_static/js/search.js" type="text/javascript"></script>
<script src="../../_static/js/navbar.js" type="text/javascript"></script>
<script src="../../_static/js/clipboard.min.js" type="text/javascript"></script>
<script src="../../_static/js/copycode.js" type="text/javascript"></script>
<script src="../../_static/js/page.js" type="text/javascript"></script>
<script src="../../_static/js/docversion.js" type="text/javascript"></script>
<script type="text/javascript">
        $('body').ready(function () {
            $('body').css('visibility', 'visible');
        });
    </script>
</body>
</html>