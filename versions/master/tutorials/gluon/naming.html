<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="Naming of Gluon Parameter and Blocks" property="og:title">
<meta content="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/og-logo.png" property="og:image">
<meta content="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/og-logo.png" property="og:image:secure_url">
<meta content="Naming of Gluon Parameter and Blocks" property="og:description"/>
<title>Naming of Gluon Parameter and Blocks — mxnet  documentation</title>
<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" rel="stylesheet"/>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet"/>
<link href="../../_static/basic.css" rel="stylesheet" type="text/css">
<link href="../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../_static/mxnet.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
<script src="https://code.jquery.com/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="../../_static/underscore.js" type="text/javascript"></script>
<script src="../../_static/searchtools_custom.js" type="text/javascript"></script>
<script src="../../_static/doctools.js" type="text/javascript"></script>
<script src="../../_static/selectlang.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script type="text/javascript"> jQuery(function() { Search.loadIndex("/searchindex.js"); Search.init();}); </script>
<script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
      Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-96378503-1', 'auto');
      ga('send', 'pageview');

    </script>
<!-- -->
<!-- <script type="text/javascript" src="../../_static/jquery.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="../../_static/underscore.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="../../_static/doctools.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
<!-- -->
<link href="../../genindex.html" rel="index" title="Index">
<link href="../../search.html" rel="search" title="Search"/>
<link href="index.html" rel="up" title="Tutorials"/>
<link href="ndarray.html" rel="next" title="NDArray - Scientific computing on CPU and GPU"/>
<link href="multi_gpu.html" rel="prev" title="Multiple GPUs training with Gluon API"/>
<link href="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet-icon.png" rel="icon" type="image/png"/>
</link></link></link></meta></meta></meta></head>
<body background="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet-background-compressed.jpeg" role="document">
<div class="content-block"><div class="navbar navbar-fixed-top">
<div class="container" id="navContainer">
<div class="innder" id="header-inner">
<h1 id="logo-wrap">
<a href="../../" id="logo"><img src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet_logo.png"/></a>
</h1>
<nav class="nav-bar" id="main-nav">
<a class="main-nav-link" href="../../install/index.html">Install</a>
<span id="dropdown-menu-position-anchor">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Gluon <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu">
<li><a class="main-nav-link" href="../../gluon/index.html">About</a></li>
<li><a class="main-nav-link" href="https://www.d2l.ai/">Dive into Deep Learning</a></li>
<li><a class="main-nav-link" href="https://gluon-cv.mxnet.io">GluonCV Toolkit</a></li>
<li><a class="main-nav-link" href="https://gluon-nlp.mxnet.io/">GluonNLP Toolkit</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">API <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu">
<li><a class="main-nav-link" href="../../api/python/index.html">Python</a></li>
<li><a class="main-nav-link" href="../../api/c++/index.html">C++</a></li>
<li><a class="main-nav-link" href="../../api/clojure/index.html">Clojure</a></li>
<li><a class="main-nav-link" href="../../api/java/index.html">Java</a></li>
<li><a class="main-nav-link" href="../../api/julia/index.html">Julia</a></li>
<li><a class="main-nav-link" href="../../api/perl/index.html">Perl</a></li>
<li><a class="main-nav-link" href="../../api/r/index.html">R</a></li>
<li><a class="main-nav-link" href="../../api/scala/index.html">Scala</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor-docs">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Docs <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu-docs">
<li><a class="main-nav-link" href="../../faq/index.html">FAQ</a></li>
<li><a class="main-nav-link" href="../../tutorials/index.html">Tutorials</a>
<li><a class="main-nav-link" href="https://github.com/apache/incubator-mxnet/tree/master/example">Examples</a></li>
<li><a class="main-nav-link" href="../../architecture/index.html">Architecture</a></li>
<li><a class="main-nav-link" href="https://cwiki.apache.org/confluence/display/MXNET/Apache+MXNet+Home">Developer Wiki</a></li>
<li><a class="main-nav-link" href="../../api/python/gluon/model_zoo.html">Model Zoo</a></li>
<li><a class="main-nav-link" href="../../api/python/contrib/onnx.html">ONNX</a></li>
</li></ul>
</span>
<span id="dropdown-menu-position-anchor-community">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Community <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu-community">
<li><a class="main-nav-link" href="http://discuss.mxnet.io">Forum</a></li>
<li><a class="main-nav-link" href="https://github.com/apache/incubator-mxnet">Github</a></li>
<li><a class="main-nav-link" href="../../community/contribute.html">Contribute</a></li>
<li><a class="main-nav-link" href="../../community/ecosystem.html">Ecosystem</a></li>
<li><a class="main-nav-link" href="../../community/powered_by.html">Powered By</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor-version" style="position: relative"><a href="#" class="main-nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true">Versions(master)<span class="caret"></span></a><ul id="package-dropdown-menu" class="dropdown-menu"><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.5.0/index.html>1.5.0</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.4.1/index.html>1.4.1</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.3.1/index.html>1.3.1</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.2.1/index.html>1.2.1</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.1.0/index.html>1.1.0</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.0.0/index.html>1.0.0</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/0.12.1/index.html>0.12.1</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/0.11.0/index.html>0.11.0</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/master/index.html>master</a></li></ul></span></nav>
<script> function getRootPath(){ return "../../" } </script>
<div class="burgerIcon dropdown">
<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">☰</a>
<ul class="dropdown-menu" id="burgerMenu">
<li><a href="../../install/index.html">Install</a></li>
<li><a class="main-nav-link" href="../../tutorials/index.html">Tutorials</a></li>
<li class="dropdown-submenu dropdown">
<a aria-expanded="true" aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" tabindex="-1">Gluon</a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu">
<li><a class="main-nav-link" href="../../gluon/index.html">About</a></li>
<li><a class="main-nav-link" href="http://gluon.mxnet.io">The Straight Dope (Tutorials)</a></li>
<li><a class="main-nav-link" href="https://gluon-cv.mxnet.io">GluonCV Toolkit</a></li>
<li><a class="main-nav-link" href="https://gluon-nlp.mxnet.io/">GluonNLP Toolkit</a></li>
</ul>
</li>
<li class="dropdown-submenu">
<a aria-expanded="true" aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" tabindex="-1">API</a>
<ul class="dropdown-menu">
<li><a class="main-nav-link" href="../../api/python/index.html">Python</a></li>
<li><a class="main-nav-link" href="../../api/c++/index.html">C++</a></li>
<li><a class="main-nav-link" href="../../api/clojure/index.html">Clojure</a></li>
<li><a class="main-nav-link" href="../../api/java/index.html">Java</a></li>
<li><a class="main-nav-link" href="../../api/julia/index.html">Julia</a></li>
<li><a class="main-nav-link" href="../../api/perl/index.html">Perl</a></li>
<li><a class="main-nav-link" href="../../api/r/index.html">R</a></li>
<li><a class="main-nav-link" href="../../api/scala/index.html">Scala</a></li>
</ul>
</li>
<li class="dropdown-submenu">
<a aria-expanded="true" aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" tabindex="-1">Docs</a>
<ul class="dropdown-menu">
<li><a href="../../faq/index.html" tabindex="-1">FAQ</a></li>
<li><a href="../../tutorials/index.html" tabindex="-1">Tutorials</a></li>
<li><a href="https://github.com/apache/incubator-mxnet/tree/master/example" tabindex="-1">Examples</a></li>
<li><a href="../../architecture/index.html" tabindex="-1">Architecture</a></li>
<li><a href="https://cwiki.apache.org/confluence/display/MXNET/Apache+MXNet+Home" tabindex="-1">Developer Wiki</a></li>
<li><a href="../../api/python/gluon/model_zoo.html" tabindex="-1">Gluon Model Zoo</a></li>
<li><a href="../../api/python/contrib/onnx.html" tabindex="-1">ONNX</a></li>
</ul>
</li>
<li class="dropdown-submenu dropdown">
<a aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" role="button" tabindex="-1">Community</a>
<ul class="dropdown-menu">
<li><a href="http://discuss.mxnet.io" tabindex="-1">Forum</a></li>
<li><a href="https://github.com/apache/incubator-mxnet" tabindex="-1">Github</a></li>
<li><a href="../../community/contribute.html" tabindex="-1">Contribute</a></li>
<li><a href="../../community/ecosystem.html" tabindex="-1">Ecosystem</a></li>
<li><a href="../../community/powered_by.html" tabindex="-1">Powered By</a></li>
</ul>
</li>
<li id="dropdown-menu-position-anchor-version-mobile" class="dropdown-submenu" style="position: relative"><a href="#" tabindex="-1">Versions(master)</a><ul class="dropdown-menu"><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.5.0/index.html>1.5.0</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.4.1/index.html>1.4.1</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.3.1/index.html>1.3.1</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.2.1/index.html>1.2.1</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.1.0/index.html>1.1.0</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.0.0/index.html>1.0.0</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/0.12.1/index.html>0.12.1</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/0.11.0/index.html>0.11.0</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/master/index.html>master</a></li></ul></li></ul>
</div>
<div class="plusIcon dropdown">
<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button"><span aria-hidden="true" class="glyphicon glyphicon-plus"></span></a>
<ul class="dropdown-menu dropdown-menu-right" id="plusMenu"></ul>
</div>
<div id="search-input-wrap">
<form action="../../search.html" autocomplete="off" class="" method="get" role="search">
<div class="form-group inner-addon left-addon">
<i class="glyphicon glyphicon-search"></i>
<input class="form-control" name="q" placeholder="Search" type="text"/>
</div>
<input name="check_keywords" type="hidden" value="yes">
<input name="area" type="hidden" value="default"/>
</input></form>
<div id="search-preview"></div>
</div>
<div id="searchIcon">
<span aria-hidden="true" class="glyphicon glyphicon-search"></span>
</div>
<!-- <div id="lang-select-wrap"> -->
<!--   <label id="lang-select-label"> -->
<!--     <\!-- <i class="fa fa-globe"></i> -\-> -->
<!--     <span></span> -->
<!--   </label> -->
<!--   <select id="lang-select"> -->
<!--     <option value="en">Eng</option> -->
<!--     <option value="zh">中文</option> -->
<!--   </select> -->
<!-- </div> -->
<!--     <a id="mobile-nav-toggle">
        <span class="mobile-nav-toggle-bar"></span>
        <span class="mobile-nav-toggle-bar"></span>
        <span class="mobile-nav-toggle-bar"></span>
      </a> -->
</div>
</div>
</div>
<script type="text/javascript">
        $('body').css('background', 'white');
    </script>
<div class="container">
<div class="row">
<div aria-label="main navigation" class="sphinxsidebar leftsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">MXNet APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/index.html">MXNet Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">MXNet Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">MXNet FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gluon/index.html">About Gluon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Installing MXNet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html#nvidia-jetson-devices">NVIDIA Jetson Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html#source-download">Source Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model_zoo/index.html">MXNet Model Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Tutorials</a></li>
</ul>
</div>
</div>
<div class="content">
<div class="page-tracker"></div>
<!--- Licensed to the Apache Software Foundation (ASF) under one -->
<!--- or more contributor license agreements.  See the NOTICE file -->
<!--- distributed with this work for additional information -->
<!--- regarding copyright ownership.  The ASF licenses this file -->
<!--- to you under the Apache License, Version 2.0 (the -->
<!--- "License"); you may not use this file except in compliance -->
<!--- with the License.  You may obtain a copy of the License at --><!---   http://www.apache.org/licenses/LICENSE-2.0 --><!--- Unless required by applicable law or agreed to in writing, -->
<!--- software distributed under the License is distributed on an -->
<!--- "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY -->
<!--- KIND, either express or implied.  See the License for the -->
<!--- specific language governing permissions and limitations -->
<!--- under the License. --><div class="section" id="naming-of-gluon-parameter-and-blocks">
<span id="naming-of-gluon-parameter-and-blocks"></span><h1>Naming of Gluon Parameter and Blocks<a class="headerlink" href="#naming-of-gluon-parameter-and-blocks" title="Permalink to this headline">¶</a></h1>
<p>In Gluon, each <a class="reference external" href="https://mxnet.incubator.apache.org/versions/master/api/python/gluon/gluon.html#mxnet.gluon.Parameter"><code class="docutils literal"><span class="pre">Parameter</span></code></a> has a name and each <a class="reference external" href="https://mxnet.incubator.apache.org/versions/master/api/python/gluon/gluon.html#mxnet.gluon.Block"><code class="docutils literal"><span class="pre">Block</span></code></a> has a prefix. <code class="docutils literal"><span class="pre">Parameter</span></code> names are specified by users, and <code class="docutils literal"><span class="pre">Block</span></code> names can be either specified by users or automatically created.</p>
<p>In this tutorial we talk about the best practices on naming. First, let’s import MXNet and Gluon:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">mxnet</span> <span class="kn">as</span> <span class="nn">mx</span>
<span class="kn">from</span> <span class="nn">mxnet</span> <span class="kn">import</span> <span class="n">gluon</span>
</pre></div>
</div>
<div class="section" id="naming-blocks">
<span id="naming-blocks"></span><h2>Naming Blocks<a class="headerlink" href="#naming-blocks" title="Permalink to this headline">¶</a></h2>
<p>When you create a <code class="docutils literal"><span class="pre">Block</span></code>, you can assign it a prefix:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">mydense</span> <span class="o">=</span> <span class="n">gluon</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">'mydense_'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">mydense</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">mydense</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>The prefix of the <code class="docutils literal"><span class="pre">Block</span></code> acts like its name. As you can see from the example above, the only difference is that the last <code class="docutils literal"><span class="pre">_</span></code> is removed from the <code class="docutils literal"><span class="pre">Block</span></code>‘s name.</p>
<p>When no prefix is given, <code class="docutils literal"><span class="pre">Gluon</span></code> will automatically generate one:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">dense0</span> <span class="o">=</span> <span class="n">gluon</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">dense0</span><span class="o">.</span><span class="n">prefix</span>
</pre></div>
</div>
<p>When you create more Blocks of the same kind, they will be named with an incrementing indices to avoid naming collision. To illustrate that, let’s create a new <code class="docutils literal"><span class="pre">Dense</span></code> layer without specifying the prefix:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">dense1</span> <span class="o">=</span> <span class="n">gluon</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">dense1</span><span class="o">.</span><span class="n">prefix</span>
</pre></div>
</div>
<p>As we can see prefixes of <code class="docutils literal"><span class="pre">dense0</span></code> and <code class="docutils literal"><span class="pre">dense1</span></code> blocks are different.</p>
</div>
<div class="section" id="naming-parameters">
<span id="naming-parameters"></span><h2>Naming Parameters<a class="headerlink" href="#naming-parameters" title="Permalink to this headline">¶</a></h2>
<p>Parameters within a <code class="docutils literal"><span class="pre">Block</span></code> will be named by prepending the prefix of the <code class="docutils literal"><span class="pre">Block</span></code> to the name of the <code class="docutils literal"><span class="pre">Parameter</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">dense0</span><span class="o">.</span><span class="n">collect_params</span><span class="p">()</span>
</pre></div>
</div>
<p>As we can see, both <code class="docutils literal"><span class="pre">weight</span></code> and <code class="docutils literal"><span class="pre">bias</span></code> parameters of the <code class="docutils literal"><span class="pre">Dense</span></code> block have the same prefix <code class="docutils literal"><span class="pre">dense0_</span></code>.</p>
<p>If you create a new <code class="docutils literal"><span class="pre">Parameter</span></code>, for example, when you <a class="reference external" href="https://mxnet.incubator.apache.org/versions/master/tutorials/gluon/custom_layer.html#parameters-of-a-custom-layer">create a custom block</a>, you have to specify its name as Gluon cannot set a default one.</p>
</div>
<div class="section" id="name-scopes">
<span id="name-scopes"></span><h2>Name scopes<a class="headerlink" href="#name-scopes" title="Permalink to this headline">¶</a></h2>
<p>To manage the names of nested Blocks, each <code class="docutils literal"><span class="pre">Block</span></code> has a <code class="docutils literal"><span class="pre">name_scope</span></code> attached to it. All Blocks created within a name scope will have its parent <code class="docutils literal"><span class="pre">Block</span></code>‘s prefix prepended to its name. We can retrieve the <code class="docutils literal"><span class="pre">name_scope</span></code> by using <a class="reference external" href="https://mxnet.incubator.apache.org/versions/master/api/python/gluon/gluon.html#mxnet.gluon.Block.name_scope"><code class="docutils literal"><span class="pre">.name_scope()</span></code></a> method of the <code class="docutils literal"><span class="pre">Block</span></code>.</p>
<p>Let’s demonstrate this by first defining a simple neural network:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">gluon</span><span class="o">.</span><span class="n">Block</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_scope</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dense0</span> <span class="o">=</span> <span class="n">gluon</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">gluon</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mydense</span> <span class="o">=</span> <span class="n">gluon</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">'mydense_'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">nd</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dense0</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">nd</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">mx</span><span class="o">.</span><span class="n">nd</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mydense</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<p>Here we defined three <code class="docutils literal"><span class="pre">Dense</span></code> layers, out of which only the last one has a prefix. Now, let’s create and initialize our network.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">model0</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<span class="n">model0</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="n">model0</span><span class="p">(</span><span class="n">mx</span><span class="o">.</span><span class="n">nd</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="n">model0</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model0</span><span class="o">.</span><span class="n">dense0</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model0</span><span class="o">.</span><span class="n">dense1</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model0</span><span class="o">.</span><span class="n">mydense</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>Note that <code class="docutils literal"><span class="pre">model0.dense0</span></code> is named as <code class="docutils literal"><span class="pre">model0_dense0_</span></code> instead of <code class="docutils literal"><span class="pre">dense0_</span></code>.</li>
<li>As before, to avoid naming collision, the next <code class="docutils literal"><span class="pre">Dense</span></code> layer got automatic prefix <code class="docutils literal"><span class="pre">dense1_</span></code>, and its full prefix is <code class="docutils literal"><span class="pre">model0_dense1_</span></code>.</li>
<li>Also note that although we specified <code class="docutils literal"><span class="pre">mydense_</span></code> as prefix for <code class="docutils literal"><span class="pre">model.mydense</span></code>, its parent’s prefix is automatically prepended to generate the prefix <code class="docutils literal"><span class="pre">model0_mydense_</span></code>.</li>
</ul>
<p>If we create another instance of <code class="docutils literal"><span class="pre">Model</span></code>, it will be given a different name like shown before in the example with the <code class="docutils literal"><span class="pre">Dense</span></code> layer.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">model1</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">dense0</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">dense1</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">mydense</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal"><span class="pre">model1.dense0</span></code> is still named as <code class="docutils literal"><span class="pre">dense0_</span></code> instead of <code class="docutils literal"><span class="pre">dense2_</span></code>, following <code class="docutils literal"><span class="pre">Dense</span></code> layers in previously created <code class="docutils literal"><span class="pre">model0</span></code>. This is because each instance of model’s name scope is independent of each other.</p>
<p><strong>It is recommended that you manually specify a prefix for the top level <code class="docutils literal"><span class="pre">Block</span></code>, i.e. <code class="docutils literal"><span class="pre">model</span> <span class="pre">=</span> <span class="pre">Model(prefix='mymodel_')</span></code>, to avoid potential confusion in naming.</strong></p>
<p>The same principle applies to container blocks like <a class="reference external" href="https://mxnet.incubator.apache.org/versions/master/api/python/gluon/gluon.html#mxnet.gluon.nn.Sequential"><code class="docutils literal"><span class="pre">Sequential</span></code></a>. <code class="docutils literal"><span class="pre">name_scope</span></code> can be used inside as well as outside of <code class="docutils literal"><span class="pre">__init__</span></code>. It is recommended to use <code class="docutils literal"><span class="pre">name_scope</span></code> with container blocks as the naming of the parameters inside of it tends to be more clear.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">gluon</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="k">with</span> <span class="n">net</span><span class="o">.</span><span class="n">name_scope</span><span class="p">():</span>
    <span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gluon</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
    <span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gluon</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">net</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">net</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
</pre></div>
</div>
<p>Models loaded from <a class="reference external" href="https://mxnet.incubator.apache.org/versions/master/api/python/gluon/model_zoo.html#module-mxnet.gluon.model_zoo"><code class="docutils literal"><span class="pre">gluon.model_zoo</span></code></a> behave in a similar way:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">gluon</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="k">with</span> <span class="n">net</span><span class="o">.</span><span class="n">name_scope</span><span class="p">():</span>
    <span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gluon</span><span class="o">.</span><span class="n">model_zoo</span><span class="o">.</span><span class="n">vision</span><span class="o">.</span><span class="n">alexnet</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
    <span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gluon</span><span class="o">.</span><span class="n">model_zoo</span><span class="o">.</span><span class="n">vision</span><span class="o">.</span><span class="n">alexnet</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="n">net</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="n">net</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="saving-and-loading-of-parameters">
<span id="saving-and-loading-of-parameters"></span><h2>Saving and loading of parameters<a class="headerlink" href="#saving-and-loading-of-parameters" title="Permalink to this headline">¶</a></h2>
<p>Because <code class="docutils literal"><span class="pre">model0</span></code> and <code class="docutils literal"><span class="pre">model1</span></code> have different prefixes, their parameters also have different names:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">model0</span><span class="o">.</span><span class="n">collect_params</span><span class="p">(),</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">collect_params</span><span class="p">())</span>
</pre></div>
</div>
<p>As a result, if you try to save parameters of <code class="docutils literal"><span class="pre">model0</span></code> and then load it into <code class="docutils literal"><span class="pre">model1</span></code>, you’ll get an error due to unmatching names:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">model0</span><span class="o">.</span><span class="n">collect_params</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">'model.params'</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">model1</span><span class="o">.</span><span class="n">collect_params</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'model.params'</span><span class="p">,</span> <span class="n">mx</span><span class="o">.</span><span class="n">cpu</span><span class="p">())</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<p>To solve this problem, we use <code class="docutils literal"><span class="pre">save_parameters</span></code>/<code class="docutils literal"><span class="pre">load_parameters</span></code> instead of <code class="docutils literal"><span class="pre">collect_params</span></code> and <code class="docutils literal"><span class="pre">save</span></code>/<code class="docutils literal"><span class="pre">load</span></code>. The <code class="docutils literal"><span class="pre">save_parameters</span></code> method uses model structure instead of parameter names to match parameters.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">model0</span><span class="o">.</span><span class="n">save_parameters</span><span class="p">(</span><span class="s1">'model.params'</span><span class="p">)</span>
<span class="n">model1</span><span class="o">.</span><span class="n">load_parameters</span><span class="p">(</span><span class="s1">'model.params'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">mx</span><span class="o">.</span><span class="n">nd</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'model.params'</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="replacing-blocks-in-networks-and-fine-tuning">
<span id="replacing-blocks-in-networks-and-fine-tuning"></span><h2>Replacing Blocks in networks and fine-tuning<a class="headerlink" href="#replacing-blocks-in-networks-and-fine-tuning" title="Permalink to this headline">¶</a></h2>
<p>Sometimes you may want to load a pretrained model, and replace certain Blocks in it for fine-tuning. For example, the <a class="reference external" href="https://mxnet.incubator.apache.org/versions/master/api/python/gluon/model_zoo.html#vision"><code class="docutils literal"><span class="pre">AlexNet</span></code></a> model in the model zoo has 1000 output dimensions, but maybe you have only 100 classes in your application. Let’s see how to change the number of output dimensions from 1000 to 100.</p>
<p>The first step is to load a pretrained <code class="docutils literal"><span class="pre">AlexNet</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">alexnet</span> <span class="o">=</span> <span class="n">gluon</span><span class="o">.</span><span class="n">model_zoo</span><span class="o">.</span><span class="n">vision</span><span class="o">.</span><span class="n">alexnet</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">alexnet</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">alexnet</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>In Gluon Model Zoo, all image classification models follow the format where the feature extraction layers are named <code class="docutils literal"><span class="pre">features</span></code> while the output layer is named <code class="docutils literal"><span class="pre">output</span></code>.</li>
<li>Note that the output layer is a <code class="docutils literal"><span class="pre">Dense</span></code> block with 1000 dimension outputs.</li>
<li>Some networks, including <code class="docutils literal"><span class="pre">AlexNet</span></code>, provide a way to directly specify number of output classes by using <code class="docutils literal"><span class="pre">classes</span></code> argument. We will still show how to do it in a replacing block manner for demonstration purposes.</li>
</ul>
<p>To change the output to 100 dimension, we replace it with a new <code class="docutils literal"><span class="pre">Block</span></code> which has only 100 units.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">alexnet</span><span class="o">.</span><span class="n">name_scope</span><span class="p">():</span>
    <span class="n">alexnet</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">gluon</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">alexnet</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">alexnet</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">alexnet</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="conclusion">
<span id="conclusion"></span><h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>Each <code class="docutils literal"><span class="pre">Block</span></code> has a <code class="docutils literal"><span class="pre">prefix</span></code> and each <code class="docutils literal"><span class="pre">Parameter</span></code> has a <code class="docutils literal"><span class="pre">name</span></code>. Gluon can automatically generate unique prefixes for blocks, but it is up to you to specify Parameter’s name if you create a <code class="docutils literal"><span class="pre">Parameter</span></code> yourself. Prefixes act like name spaces and create a hierarchy following the nesting of blocks in your model. To save and load model parameters, it is better to use <code class="docutils literal"><span class="pre">save_parameters</span></code>/<code class="docutils literal"><span class="pre">load_parameters</span></code> methods on the parent <code class="docutils literal"><span class="pre">Block</span></code>.</p>
</div>
<div class="section" id="recommended-next-steps">
<span id="recommended-next-steps"></span><h2>Recommended Next Steps<a class="headerlink" href="#recommended-next-steps" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Learn more about <a class="reference external" href="https://mxnet.incubator.apache.org/versions/master/tutorials/gluon/save_load_params.html">model serialization</a> in Gluon.</li>
<li><a class="reference external" href="https://mxnet.incubator.apache.org/versions/master/tutorials/gluon/custom_layer.html">Create custom blocks</a> with your own parameters.</li>
</ul>
<div class="btn-group" role="group">
<div class="download-btn"><a download="naming.ipynb" href="naming.ipynb"><span class="glyphicon glyphicon-download-alt"></span> naming.ipynb</a></div></div></div>
</div>
</div>
</div>
<div aria-label="main navigation" class="sphinxsidebar rightsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li><a class="reference internal" href="#">Naming of Gluon Parameter and Blocks</a><ul>
<li><a class="reference internal" href="#naming-blocks">Naming Blocks</a></li>
<li><a class="reference internal" href="#naming-parameters">Naming Parameters</a></li>
<li><a class="reference internal" href="#name-scopes">Name scopes</a></li>
<li><a class="reference internal" href="#saving-and-loading-of-parameters">Saving and loading of parameters</a></li>
<li><a class="reference internal" href="#replacing-blocks-in-networks-and-fine-tuning">Replacing Blocks in networks and fine-tuning</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
<li><a class="reference internal" href="#recommended-next-steps">Recommended Next Steps</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div><div class="footer">
<div class="section-disclaimer">
<div class="container">
<div>
<img height="60" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/apache_incubator_logo.png"/>
<p>
            Apache MXNet is an effort undergoing incubation at The Apache Software Foundation (ASF), <strong>sponsored by the <i>Apache Incubator</i></strong>. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
        </p>
<p>
            "Copyright © 2017-2018, The Apache Software Foundation
            Apache MXNet, MXNet, Apache, the Apache feather, and the Apache MXNet project logo are either registered trademarks or trademarks of the Apache Software Foundation."
        </p>
</div>
</div>
</div>
</div> <!-- pagename != index -->
</div>
<script crossorigin="anonymous" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="../../_static/js/sidebar.js" type="text/javascript"></script>
<script src="../../_static/js/search.js" type="text/javascript"></script>
<script src="../../_static/js/navbar.js" type="text/javascript"></script>
<script src="../../_static/js/clipboard.min.js" type="text/javascript"></script>
<script src="../../_static/js/copycode.js" type="text/javascript"></script>
<script src="../../_static/js/page.js" type="text/javascript"></script>
<script src="../../_static/js/docversion.js" type="text/javascript"></script>
<script type="text/javascript">
        $('body').ready(function () {
            $('body').css('visibility', 'visible');
        });
    </script>
</body>
</html>