<!---
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing,
  software distributed under the License is distributed on an
  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, either express or implied.  See the License for the
  specific language governing permissions and limitations
  under the License.
-->
---
layout: default
---
<script>

</script>
<article class="post">

    <header class="post-header wrapper">
        <h1 class="post-title">Code Guide and Tips</h1>
        <h3>Tips in MXNet codebase for reviewers and contributors.</h3><a style="float:left; margin-top:20px" href="/versions/master/community/index" class="btn btn-action">Contribute
            <span class="span-accented">â€º</span></a></header>

    <div class="post-content">
        <div class="wrapper">
            <!--- Licensed to the Apache Software Foundation (ASF) under one -->
<!--- or more contributor license agreements.  See the NOTICE file -->
<!--- distributed with this work for additional information -->
<!--- regarding copyright ownership.  The ASF licenses this file -->
<!--- to you under the Apache License, Version 2.0 (the -->
<!--- "License"); you may not use this file except in compliance -->
<!--- with the License.  You may obtain a copy of the License at -->

<!---   http://www.apache.org/licenses/LICENSE-2.0 -->

<!--- Unless required by applicable law or agreed to in writing, -->
<!--- software distributed under the License is distributed on an -->
<!--- "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY -->
<!--- KIND, either express or implied.  See the License for the -->
<!--- specific language governing permissions and limitations -->
<!--- under the License. -->

<h1 id="code-guide-and-tips">Code Guide and Tips</h1>

<p>This is a document used to record tips in MXNet codebase for reviewers and
contributors. Most of them are summarized through lessons during the
contributing and process.</p>

<h2 id="c-code-styles">C++ Code Styles</h2>

<ul>
  <li>Use the <a href="https://google.github.io/styleguide/cppguide.html">Google C/C++ style</a>.</li>
  <li>The public facing functions are documented in <a href="https://www.doxygen.nl/manual/docblocks.html">doxygen</a> format.</li>
  <li>Favor concrete type declaration over <code class="highlighter-rouge">auto</code> as long as it is short.</li>
  <li>Favor passing by const reference (e.g. <code class="highlighter-rouge">const Expr&amp;</code>) over passing
by value. Except when the function consumes the value by copy
constructor or move, pass by value is better than pass by const
reference in such cases.</li>
  <li>Favor <code class="highlighter-rouge">const</code> member function when possible.</li>
  <li>Use <a href="https://en.cppreference.com/w/cpp/language/raii">RAII</a> to manage resources, including smart pointers like shared_ptr and unique_ptr as well as allocating in constructors and deallocating in destructors. Avoid explicit calls to new and delete when possible. Use make_shared and make_unique instead.</li>
</ul>

<p>We use <a href="https://github.com/cpplint/cpplint"><code class="highlighter-rouge">cpplint</code></a> to enforce the code style. Because
different version of <code class="highlighter-rouge">cpplint</code> might change by its version, it is
recommended to use the same version of the <code class="highlighter-rouge">cpplint</code> as the master.
You can also use the following command via docker.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ci/build.py <span class="nt">-R</span> <span class="nt">--docker-registry</span> mxnetci <span class="nt">--platform</span> ubuntu_cpu <span class="nt">--docker-build-retries</span> 3 <span class="nt">--shm-size</span> 500m /work/runtime_functions.sh sanity_cpp
</code></pre></div></div>

<p><code class="highlighter-rouge">cpplint</code> is also not perfect, when necessary, you can use disable
<code class="highlighter-rouge">cpplint</code> on certain code regions.</p>

<h2 id="python-code-styles">Python Code Styles</h2>

<ul>
  <li>The functions and classes are documented in
<a href="https://numpydoc.readthedocs.io/en/latest/">numpydoc</a> format.</li>
  <li>Check your code style using <code class="highlighter-rouge">make pylint</code></li>
  <li>Stick to language features as in <code class="highlighter-rouge">python 3.6</code> and above.</li>
</ul>

<h2 id="testing">Testing</h2>

<p>Our tests are maintained in the <a href="https://github.com/apache/incubator-mxnet/tree/master/tests">/tests</a> folder. We use the following testing tools:</p>
<ul>
  <li>For Python, we use <a href="https://pytest.org">pytest</a>.
    <ul>
      <li>An example of setting up and running tests (tested on MacOS with Python 3.6):
        <ul>
          <li>follow the <a href="https://mxnet.apache.org/get_started/build_from_source">build from source</a> guide to build MXNet</li>
          <li>install python libraries
            <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 -m pip install opencv-python
python3 -m pip install -r ci/docker/install/requirements
</code></pre></div>            </div>
          </li>
          <li>install MXNet Python bindings:
            <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 -m pip install -e ./python
</code></pre></div>            </div>
          </li>
          <li>run tests in a specific module
            <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 -m pytest tests/python/unittest/test_smoke.py
</code></pre></div>            </div>
          </li>
          <li>or run a specific test in a module
            <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 -m pytest tests/python/unittest/test_smoke.py::test_18927
</code></pre></div>            </div>
          </li>
          <li>or run all the Python unittests
            <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 -m pytest tests/python/unittest/
</code></pre></div>            </div>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>For C++, we use <a href="https://github.com/google/googletest">gtest</a>.</li>
</ul>

<p>Our CI pipelines check for a wide variety of configuration on all platforms. To locate and reproduce
a test issue in PR, you can refer to the process described in <a href="https://github.com/apache/incubator-mxnet/issues/18723">#18723</a></p>

<script async="" defer="" src="https://buttons.github.io/buttons.js"></script>

<script src="https://apis.google.com/js/platform.js"></script>


        </div>
    </div>

</article>
